<html lang="en">
<head>
  <meta charset="utf-8"/>
  {{#if member}}
    <title>Honsan - {{member.first_name}} {{member.last_name}}</title>
  {{else}}
    <title>Honsan - Bad Member</title>
  {{/if}}
  <link rel="shortcut icon" href="/assets/media/favicon.png"/>
  <link rel="stylesheet" type="text/css" href="/assets/main.css"/>
  <script src="/assets/helper.js" type="text/javascript"></script>
  <script src="/assets/signout.js" type="text/javascript"></script>
  <script src="/assets/signin.js" type="text/javascript"></script>
</head>
<body>
  <img src='/assets/media/banner.png' alt='A Banner Ad (eventually)' id='banner-ad'>
  <ul id='navbar'>
    <li><a href='/'>New Entry</a></li>
    <li><a href='/add_member'>Add Member</a></li>
    <li><a href='/catalogue'>Catalog</a></li>
    <li><a href='/member_list'>Member List</a></li>
    <li><a href='/logout'>Log Out</a></li>
  </ul>
  <div id='content'>
    <div id='member-container'>
      {{#if member}}
        <div class='member-entry'>
          <h1>{{member.first_name}} {{member.last_name}}</h1>
          <p><b>Email:</b> {{member.email}}</p>
          <p><b>Cards:</b> 
            {{#each member.cards}}
              <span class='member-card'>{{this}}</span>{{#if @last}}{{else}}, {{/if}}
            {{/each}}
          </p>
          <div class='borrowed-container'>
            <h2>Borrowed Items:</h2>
            <table>
              <tr>
                <th>Entry</th>
                <th>Copy</th>
                <th>Nickname</th>
                <th>Quality</th>
                <th>Due Date</th>
              </tr>
            {{#if member.borrowed}}
                {{#each member.borrowed}}
                <tr>
                  <td><a href='/entry?id={{this.entry_id}}'>{{this.entry_name}}</a></td>
                  <td>{{this.name}}</td>
                  <td>{{this.nickname}}</td>
                  <td>{{this.quality}}</td>
                  <td>Due {{this.due_date_str}}</td>
                  {{#if this.due_date}}
                    <td><button type='button'
                            onclick='Renew("{{this.copy_id}}", "{{../csrfToken}}")'>Renewal</button></td>
                    <td><button type='button'
                            onclick='SignIn("{{this.copy_id}}", "{{../csrfToken}}")'>Sign In</button></td>
                  {{/if}}
                </tr>
                {{/each}}
              {{else}}
                <tr><td colspan='5'>No borrowed items.</td></tr>
              {{/if}}
            </table>
          </div>
          <div id='signin-results'></div>
          <div id='signout-nickname-container'>
            <h2>Sign Out:</h2>
            <form id='signout-nickname-form'
                  name='signout-nickname-form'
                  class='signout-nickname-form'>
              <label for='nickname'>Copy Nickname:
                <input class='signout-nickname' type='text' name='nickname' placeholder='nickname' />
              </label>
              <input class='signout-nickname-member' type='hidden' name='memberId' value='{{member.member_id}}' />
              <input type='hidden' name='_csrf' value='{{csrfToken}}' />
              <input class='signout-nickname-submit' type='submit' value='Sign Out Copy' />
            </form>
            <div id='signout-nickname-results'></div>
          </div>
          <div id='signout-container'>
            <h2>Sign Out by Search:</h2>
            <form id='signout-search-form'
                  name='signout-search-form'
                  class='signout-search-form'>
              <input class='signout-search' type='text' name='search' placeholder='search term' />
              <input type='hidden' name='_csrf' value='{{csrfToken}}' />
              <input class='signout-search-submit' type='submit' value='Search Catalogue' />
            </form>
            <div id='signout-search-results'></div>
          </div>
        </div>
      {{else}}
        <h2>Member ID is not valid.</h2>
      {{/if}}
    </div>
  </div>
</body>
</html>